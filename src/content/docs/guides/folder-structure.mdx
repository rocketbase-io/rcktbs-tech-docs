---
title: Folder Structure
description: Wo liegt ws und wir ist die Philosophie / erkennbare Muster für bessere Wartbarkeit
---
import { FileTree, Tabs, TabItem } from '@astrojs/starlight/components';
import { Grid, GridItem } from '@/components';

In einem Monorepo ist es nicht so leicht die unterschiedlichen Betrachtungsweisen (Backend/Frontend/Middlewear) alle im gleichen Maße zu berücksichtigen. Einige Frameworks wie tanstack-router sind durch file-based-routing recht prägend und andere wie trpc lassen einem alle Optionen offen :)

Nachfolgend habe ich versucht zunächst eine globale Ansicht der Struktur des Gesamten Projektes zu skizzieren. In den nachfolgenden Abschnitten gehe ich dann spezifisch auf Packages/Apps und ihre Besonderheiten ein.

<FileTree>
- package.json
- apps/
    - server/
        - src/
            - lib/
                - logger.ts
                - auth.ts
            - router/
                - index.ts
                - \{ENTITY_GROUP}/
                    - index.ts
                    - \{ENTITY}/
                        - router.ts
                        - service.ts
            - tests/
            - env.ts
            - index.ts
    - web/
        - src/
            - shared/
                - components/
                - hooks/
                - i18n/
                - format/
            - routes/
                - _authenticated/
                    - employees/
                        - -components/
                            - create-dialog.tsx used in index with queryParam as open/close state
                        - -hooks/
                        - index.tsx
                        - $employeeId/
                            - -components/
                            - general.tsx
                            - supported-products.tsx
                            - index.tsx
            - main.tsx
            - index.css
            - routeTree.gen.ts
        - package.json
- packages/
    - api/
        - src/
            - dto/
                - _ (HoursCount, EffortBreakdown...)
            - calculation/
                - _ (margin, employeeVZE...)
            - schema/
                - index.ts collects all groups
                - \{ENTITY_GROUP}/
                    - index.ts
                    - entity.ts
        - package.json
    - drizzle/
        - migration/
        - src/
            - schema/
                - types/
                    - decimaljs.ts
                    - nanoid.ts
                - \{ENTITY_GROUP}/
                    - index.ts
                    - entity.ts
                index.ts
            - seed/
            - utils/
                - take-unique.ts
        - drizzle.config.ts
        - package.json
</FileTree>

## apps

Hierunter verbergen sich ausführbare Anwendungsbestandteile primär **server** (mit db-zugriff und api-schnittstellen) und **web** (mit entsprechenden ui-interfaces).

### server

Aktuell ein Express-Server welche mit Hilfe von [TRPC](https://trpc.io/) api-endpunkte in einer typesafty für das frontend bereitstellt.

#### dependencies

<Grid>
    <GridItem>
        - @rep/drizzle
        - @rep/api
        - @rep/mail
    </GridItem>
    <GridItem>
        - [trpc](https://trpc.io/)
        - [express](https://expressjs.com/)
        - [mapbox](https://www.mapbox.com/)
        - [aws-s3](https://www.npmjs.com/package/@aws-sdk/client-s3)
        - [puppeteer](https://pptr.dev/)
    </GridItem>
</Grid>

### entity group

Um etwas mehr Struktur dem projekt zu geben, macht es Sinn entitäten/objekte zusammen unter einem ordner zu bündeln.

<FileTree>
- index.ts
- employee/
    - employee.ts
    - employee-qualification.ts
    - index.ts
- product/
    - product.ts
    - product-part.ts
    - product-bundle.ts
    - index.ts
</FileTree>

Codeseitig würde es dann so aussehen:

<Tabs>
<TabItem label="index.ts">
```typescript
export const appRouter = t.router({
employee: employeeRouter,
product: productRouter,
});
```
</TabItem>
<TabItem label="employee/index.ts">
```typescript
export const employeeGroupRouter = router({
    employee: employeeRouter,
    employeeQualification: employeeQualificationRouter,
});
```
</TabItem>
<TabItem label="employee/employee.ts">
```typescript
export const employeeRouter = router({
    create: protectedRoleProcedure('user')
        .input(employeeSchema.create)
        .output(employeeSchema.read)
        .mutation(async ({ ctx, input }) => {
            // ...
        })
});
```
</TabItem>
</Tabs>

Die **3 Stufige** verleiht unseren routes und den ordnern eine bessere struktur und lässt leichter anhand von trpc und co die relevanten Dateien finden.


